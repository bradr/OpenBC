#!/usr/bin/perl 
use strict; 
use warnings; 
use Template; 
use FindBin;
use Fatal qw/open close/;
use YAML;

my $file = "toc.html"; 
my $template = "toc.tt2";
my $output;

my @data = YAML::LoadFile("data.yaml");

my $tt = Template->new({
        INCLUDE_PATH => "$FindBin::Bin/../template",
});

my @vars;
for my $record (@data) {
#    while ( my ($key, $value) = each(%$record) ) {
#        push @vars, $key=>$value;
#    }
    foreach (%$record) { push @vars, %$record;}
}

$tt->process($template, @vars, $file, {})
    || die "Template process failed: ", $tt->error(), "\n";
